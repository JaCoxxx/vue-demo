(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["board2"],{"52f9":function(t,i,s){"use strict";s.r(i);var a=function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{ref:"box",staticClass:"hand-writing"},[t.app?s("div",[t._v("暂不支持QQ浏览器")]):s("div",{staticStyle:{height:"100%"}},[t.filePath?s("img",{attrs:{src:t.filePath,alt:""}}):s("canvas",{ref:"writingCanvas",staticClass:"writing-box",attrs:{width:t.canvasWidth,height:t.canvasHeight},on:{touchstart:function(i){return t.handleSelectTouch(i,"start")},touchmove:function(i){return t.handleSelectTouch(i,"move")},touchend:function(i){return t.handleSelectTouch(i,"end")}}}),s("div",{staticClass:"btn-box"},[s("a-popover",{attrs:{arrowPointAtCenter:!0,getPopupContainer:t.handleGetContainer},model:{value:t.adjustVisible,callback:function(i){t.adjustVisible=i},expression:"adjustVisible"}},[s("template",{slot:"title"},[s("div",{staticClass:"adjust-header"},[s("span",[t._v("调节笔画")]),s("a-icon",{attrs:{type:"close-circle"},on:{click:function(i){t.adjustVisible=!1}}})],1)]),s("template",{slot:"content"},[s("div",{staticClass:"adjust-content"},[s("a-row",[s("a-col",{attrs:{span:8}},[t._v("线条粗细")]),s("a-col",{attrs:{span:16}},[s("a-slider",{attrs:{min:1,max:20},model:{value:t.lineWidth,callback:function(i){t.lineWidth=i},expression:"lineWidth"}})],1)],1),s("a-row",[s("a-col",{attrs:{span:8}},[t._v("线条颜色")]),s("a-col",{attrs:{span:16}},[s("div",{staticClass:"color-body",style:{background:t.lineColor},on:{click:function(i){t.colorVisible=!0}}}),t.colorVisible?s("div",{staticClass:"picker-box"},[s("a-icon",{staticClass:"picker-cancel",attrs:{type:"close-circle"},on:{click:function(i){t.colorVisible=!1}}}),s("chrome-picker",{model:{value:t.pickerColor,callback:function(i){t.pickerColor=i},expression:"pickerColor"}})],1):t._e()])],1)],1)]),s("a-button",{staticClass:"btn btn-adjust",attrs:{type:"primary"},on:{click:function(i){t.adjustVisible=!0}}},[t._v("\n          调节笔画\n        ")])],2),s("a-button",{staticClass:"btn btn-clear",attrs:{type:"primary"},on:{click:t.onClear}},[t._v("清屏")]),s("a-button",{staticClass:"btn btn-generate",attrs:{type:"primary"},on:{click:t.onGenerate}},[t._v("生成")]),s("a-button",{staticClass:"btn btn-switch",staticStyle:{padding:"0"},attrs:{type:"primary"},on:{click:function(i){t.mouseStatus="brush"===t.mouseStatus?"eraser":"brush"}}},[t._v("\n        切换为"+t._s("brush"===t.mouseStatus?"橡皮檫":"画笔")+"\n      ")]),s("a-button",{staticClass:"btn btn-undo",attrs:{type:"primary"},on:{click:t.onUndo}},[t._v("\n        撤销\n      ")]),s("a-button",{staticClass:"btn btn-reduction",attrs:{type:"primary"},on:{click:t.onReduction}},[t._v("\n        还原\n      ")])],1)])])},e=[],n=(s("a481"),s("6762"),s("2fdb"),s("c345")),o={name:"HandWriting",props:{path:{type:String,default:""}},components:{"chrome-picker":n["Chrome"]},data:function(){return{offsetWidth:0,offsetHeight:0,canvasWidth:500,canvasHeight:500,lineWidth:10,pickerColor:{},lineColor:"#000",filePath:"",c1px:0,c1py:0,adjustVisible:!1,colorVisible:!1,mouseStatus:"brush",boardData:[],boardStatus:0}},watch:{pickerColor:function(t){this.lineColor=t.hex8}},computed:{app:function(){return!!navigator.userAgent.includes("QQBrowser")}},mounted:function(){this.init()},methods:{init:function(){this.boardStatus=-1,this.boardData=[];var t=this.$refs.writingCanvas;this.canvasWidth=t.offsetWidth,this.canvasHeight=t.offsetHeight,this.ctx=t.getContext("2d"),""!==this.path?this.filePath=this.path:this.setBoardStatus(this.ctx.getImageData(0,0,this.canvasWidth,this.canvasHeight))},handleSelectTouch:function(t,i){var s=this.getInitialCapital(this.mouseStatus);switch(i){case"start":this["on".concat(s,"Start")](t);break;case"move":this["on".concat(s,"Move")](t);break;case"end":this["on".concat(s,"End")](t);break;default:break}},handleDraw:function(t){var i=t.touches[0].clientX-this.offsetLeft,s=t.touches[0].clientY-this.offsetTop;this.ctx.moveTo(this.c1px,this.c1py),this.ctx.lineTo(i,s),this.ctx.stroke(),this.c1px=i,this.c1py=s},onBrushStart:function(t){this.offsetLeft=t.target.offsetLeft,this.offsetTop=t.target.offsetTop,this.ctx.beginPath(),this.ctx.lineWidth=this.lineWidth,this.ctx.strokeStyle=this.lineColor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.c1px=t.touches[0].clientX-this.offsetLeft,this.c1py=t.touches[0].clientY-this.offsetTop,this.handleDraw(t)},onBrushMove:function(t){this.handleDraw(t)},onBrushEnd:function(){this.ctx.closePath(),this.setBoardStatus(this.ctx.getImageData(0,0,this.canvasWidth,this.canvasHeight))},onClear:function(){var t=this;this.ctx.clearRect(0,0,this.canvasWidth,this.canvasHeight),this.filePath="",this.$nextTick(function(){t.init()}),this.$emit("onClear")},onGenerate:function(){this.filePath?this.filePath=this.filePath:(this.filePath=this.$refs.writingCanvas.toDataURL(),this.$emit("onComplete",this.filePath))},onEraserStart:function(t){this.offsetLeft=t.target.offsetLeft,this.offsetTop=t.target.offsetTop,this.c1px=t.touches[0].clientX-this.offsetLeft,this.c1py=t.touches[0].clientY-this.offsetTop,this.clearArc(this.c1px,this.c1py,this.lineWidth/2)},onEraserMove:function(t){this.clearLine(t,this.lineWidth/2)},onEraserEnd:function(){this.setBoardStatus(this.ctx.getImageData(0,0,this.canvasWidth,this.canvasHeight))},clearArc:function(t,i,s){this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(t,i,s,0,2*Math.PI),this.ctx.clip(),this.ctx.clearRect(0,0,this.canvasWidth,this.canvasHeight),this.ctx.restore()},clearLine:function(t,i){this.offsetLeft=t.target.offsetLeft,this.offsetTop=t.target.offsetTop;var s=t.touches[0].clientX-this.offsetLeft,a=t.touches[0].clientY-this.offsetTop;this.clearArc(s,a,i);var e=i*Math.sin(Math.atan((a-this.c1py)/(s-this.c1px))),n=i*Math.cos(Math.atan((a-this.c1py)/(s-this.c1px)));this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(this.c1px-e,this.c1py+n),this.ctx.lineTo(this.c1px+e,this.c1py-n),this.ctx.lineTo(s+e,a-n),this.ctx.lineTo(s-e,a+n),this.ctx.closePath(),this.ctx.clip(),this.ctx.clearRect(0,0,this.canvasWidth,this.canvasHeight),this.ctx.restore(),this.c1px=s,this.c1py=a},handleGetContainer:function(){return this.$refs.box},getInitialCapital:function(t){return t.replace(/\S/,function(t){return t.toUpperCase()})},onUndo:function(){this.boardStatus--,this.boardStatus>=0?this.ctx.putImageData(this.boardData[this.boardStatus],0,0):(this.boardStatus++,this.$message.info("已经是第一步了"))},onReduction:function(){this.boardStatus++,this.boardStatus<this.boardData.length?this.ctx.putImageData(this.boardData[this.boardStatus],0,0):(this.boardStatus--,this.$message.info("已经是最新的了"))},setBoardStatus:function(t){this.boardData.push(t),this.boardStatus+=1}}},c=o,h=(s("b1bb"),s("2877")),r=Object(h["a"])(c,a,e,!1,null,"5f444e47",null);i["default"]=r.exports},ad38:function(t,i,s){},b1bb:function(t,i,s){"use strict";var a=s("ad38"),e=s.n(a);e.a}}]);
//# sourceMappingURL=board2.5f97cb60.js.map