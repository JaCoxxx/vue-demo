(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["board3"],{"41ee":function(t,s,i){},5118:function(t,s,i){"use strict";var e=i("41ee"),a=i.n(e);a.a},"9e58":function(t,s,i){"use strict";i.r(s);var e=function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{ref:"box",staticClass:"hand-writing"},[t.app?i("div",[t._v("暂不支持QQ浏览器,请选择其他浏览器打开。")]):i("div",{staticStyle:{height:"100%"}},[t.filePath?i("img",{attrs:{src:t.filePath,alt:""}}):i("canvas",{ref:"writingCanvas",staticClass:"writing-box",attrs:{width:t.canvasWidth,height:t.canvasHeight},on:{touchstart:function(s){return t.handleSelectTouch(s,"start")},touchmove:function(s){return t.handleSelectTouch(s,"move")},touchend:function(s){return t.handleSelectTouch(s,"end")}}}),i("div",{staticClass:"menu-box",style:{top:t.menuTop+"px",left:t.menuLeft+"px"},on:{touchstart:function(s){return t.onMenuStart(s)},touchmove:function(s){return t.onMenuMove(s)},touchend:function(s){return t.onMenuEnd(s)}}},[i("div",{staticClass:"menu-list",class:{"list-show":t.menuShow}},[i("div",{staticClass:"menu-btn",class:{"btn-checked":t.menuShow},on:{click:t.onClickMenuBtn}},[i("span",{staticClass:"menu-btn-item"}),i("span",{staticClass:"menu-btn-item"}),i("span",{staticClass:"menu-btn-item"})]),i("div",{staticClass:"list-item",class:{"item-checked":"brush"===t.mouseStatus}},[i("a-popover",{attrs:{placement:"right",arrowPointAtCenter:!0,getPopupContainer:t.handleGetContainer},model:{value:t.adjustVisible,callback:function(s){t.adjustVisible=s},expression:"adjustVisible"}},[i("template",{slot:"title"},[i("div",{staticClass:"adjust-header"},[i("span",[t._v("调节笔画")]),i("a-icon",{attrs:{type:"close-circle"},on:{click:function(s){t.adjustVisible=!1}}})],1)]),i("template",{slot:"content"},[i("div",{staticClass:"adjust-content"},[i("a-row",[i("a-col",{attrs:{span:8}},[t._v("线条粗细")]),i("a-col",{attrs:{span:16}},[i("a-slider",{attrs:{min:1,max:20},model:{value:t.lineWidth,callback:function(s){t.lineWidth=s},expression:"lineWidth"}})],1)],1),i("a-row",[i("a-col",{attrs:{span:8}},[t._v("线条颜色")]),i("a-col",{attrs:{span:16}},[i("div",{staticClass:"color-body",style:{background:t.lineColor},on:{click:function(s){t.colorVisible=!0}}}),t.colorVisible?i("div",{staticClass:"picker-box"},[i("a-icon",{staticClass:"picker-cancel",attrs:{type:"close-circle"},on:{click:function(s){t.colorVisible=!1}}}),i("chrome-picker",{model:{value:t.pickerColor,callback:function(s){t.pickerColor=s},expression:"pickerColor"}})],1):t._e()])],1)],1)]),i("a-icon",{attrs:{type:"edit"},on:{click:t.onClickEdit}})],2)],1),i("div",{staticClass:"list-item",class:{"item-checked":"eraser"===t.mouseStatus}},[i("a-popover",{attrs:{placement:"right",arrowPointAtCenter:!0,getPopupContainer:t.handleGetContainer},model:{value:t.eraserVisible,callback:function(s){t.eraserVisible=s},expression:"eraserVisible"}},[i("template",{slot:"title"},[i("div",{staticClass:"adjust-header"},[i("span",[t._v("调节橡皮擦")]),i("a-icon",{attrs:{type:"close-circle"},on:{click:function(s){t.eraserVisible=!1}}})],1)]),i("template",{slot:"content"},[i("div",{staticClass:"adjust-content"},[i("a-row",[i("a-col",{attrs:{span:8}},[t._v("橡皮宽度")]),i("a-col",{attrs:{span:16}},[i("a-slider",{attrs:{min:1,max:50},model:{value:t.eraserWidth,callback:function(s){t.eraserWidth=s},expression:"eraserWidth"}})],1)],1)],1)]),i("icon-font",{attrs:{type:"icon-eraser"},on:{click:t.onClickEraser}})],2)],1),i("div",{staticClass:"list-item"},[i("a-icon",{attrs:{type:"undo"},on:{click:t.onUndo}})],1),i("div",{staticClass:"list-item"},[i("a-icon",{attrs:{type:"redo"},on:{click:t.onReduction}})],1),i("div",{staticClass:"list-item"},[i("a-icon",{attrs:{type:"delete"},on:{click:t.onClear}})],1),i("div",{staticClass:"list-item"},[i("a-icon",{attrs:{type:"save"},on:{click:t.onGenerate}})],1)])])])])},a=[],n=(i("a481"),i("6762"),i("2fdb"),i("c345")),o=i("0c63"),c=o["a"].createFromIconfontCN({scriptUrl:"//at.alicdn.com/t/font_1372570_awwwx5suzr.js"}),h={name:"HandWriting",props:{path:{type:String,default:""}},components:{IconFont:c,"chrome-picker":n["Chrome"]},data:function(){return{offsetWidth:0,offsetHeight:0,canvasWidth:500,canvasHeight:500,lineWidth:10,eraserWidth:10,pickerColor:{},lineColor:"#000",filePath:"",c1px:0,c1py:0,adjustVisible:!1,colorVisible:!1,eraserVisible:!1,mouseStatus:"brush",boardData:[],boardStatus:0,menuShow:!1,menuTop:0,menuLeft:0,menuX:0,menuY:0}},watch:{pickerColor:function(t){this.lineColor=t.hex8}},computed:{app:function(){return!!navigator.userAgent.includes("QQBrowser")}},mounted:function(){this.init()},methods:{init:function(){this.mouseStatus="brush",this.boardStatus=-1,this.boardData=[];var t=this.$refs.writingCanvas;this.canvasWidth=t.offsetWidth,this.canvasHeight=t.offsetHeight,this.ctx=t.getContext("2d"),""!==this.path?this.filePath=this.path:this.setBoardStatus(this.ctx.getImageData(0,0,this.canvasWidth,this.canvasHeight))},handleSelectTouch:function(t,s){if(this.mouseStatus){var i=this.getInitialCapital(this.mouseStatus);switch(s){case"start":this["on".concat(i,"Start")](t);break;case"move":this["on".concat(i,"Move")](t);break;case"end":this["on".concat(i,"End")](t);break;default:break}}else this.$message.info("请先选择画笔")},handleDraw:function(t){var s=t.touches[0].clientX-this.offsetLeft,i=t.touches[0].clientY-this.offsetTop-38;this.ctx.moveTo(this.c1px,this.c1py),this.ctx.lineTo(s,i),this.ctx.stroke(),this.c1px=s,this.c1py=i},onBrushStart:function(t){this.offsetLeft=t.target.offsetLeft,this.offsetTop=t.target.offsetTop,this.ctx.beginPath(),this.ctx.lineWidth=this.lineWidth,this.ctx.strokeStyle=this.lineColor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.c1px=t.touches[0].clientX-this.offsetLeft,this.c1py=t.touches[0].clientY-this.offsetTop-38,this.handleDraw(t)},onBrushMove:function(t){this.handleDraw(t)},onBrushEnd:function(){this.ctx.closePath(),this.setBoardStatus(this.ctx.getImageData(0,0,this.canvasWidth,this.canvasHeight))},onClear:function(){var t=this;this.ctx.clearRect(0,0,this.canvasWidth,this.canvasHeight),this.filePath="",this.$nextTick(function(){t.init()}),this.$emit("onClear")},onGenerate:function(){this.filePath?this.filePath=this.filePath:(this.filePath=this.$refs.writingCanvas.toDataURL(),this.$emit("onComplete",this.filePath)),this.mouseStatus=""},onEraserStart:function(t){this.offsetLeft=t.target.offsetLeft,this.offsetTop=t.target.offsetTop,this.c1px=t.touches[0].clientX-this.offsetLeft,this.c1py=t.touches[0].clientY-this.offsetTop-38,this.clearArc(this.c1px,this.c1py,this.eraserWidth/2)},onEraserMove:function(t){this.clearLine(t,this.eraserWidth/2)},onEraserEnd:function(){this.setBoardStatus(this.ctx.getImageData(0,0,this.canvasWidth,this.canvasHeight))},clearArc:function(t,s,i){this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(t,s,i,0,2*Math.PI),this.ctx.clip(),this.ctx.clearRect(0,0,this.canvasWidth,this.canvasHeight),this.ctx.restore()},clearLine:function(t,s){this.offsetLeft=t.target.offsetLeft,this.offsetTop=t.target.offsetTop;var i=t.touches[0].clientX-this.offsetLeft,e=t.touches[0].clientY-this.offsetTop-38;this.clearArc(i,e,s);var a=s*Math.sin(Math.atan((e-this.c1py)/(i-this.c1px))),n=s*Math.cos(Math.atan((e-this.c1py)/(i-this.c1px)));this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(this.c1px-a,this.c1py+n),this.ctx.lineTo(this.c1px+a,this.c1py-n),this.ctx.lineTo(i+a,e-n),this.ctx.lineTo(i-a,e+n),this.ctx.closePath(),this.ctx.clip(),this.ctx.clearRect(0,0,this.canvasWidth,this.canvasHeight),this.ctx.restore(),this.c1px=i,this.c1py=e},handleGetContainer:function(){return this.$refs.box},getInitialCapital:function(t){return t.replace(/\S/,function(t){return t.toUpperCase()})},onUndo:function(){this.boardStatus--,this.boardStatus>=0?this.ctx.putImageData(this.boardData[this.boardStatus],0,0):(this.boardStatus++,this.$message.info("已经是第一步了"))},onReduction:function(){this.boardStatus++,this.boardStatus<this.boardData.length?this.ctx.putImageData(this.boardData[this.boardStatus],0,0):(this.boardStatus--,this.$message.info("已经是最新的了"))},setBoardStatus:function(t){this.boardStatus<this.boardData.length-1&&(this.boardData=this.boardData.slice(0,this.boardStatus+1)),this.boardData.push(t),this.boardStatus+=1},onClickMenuBtn:function(){this.menuShow=!this.menuShow},onMenuStart:function(t){this.menuX=t.touches[0].clientX,this.menuY=t.touches[0].clientY},onMenuMove:function(t){this.menuShow=!1;var s=t.touches[0].clientX,i=t.touches[0].clientY;this.menuTop+=i-this.menuY,this.menuLeft+=s-this.menuX;var e=this.handleBorderJudgment(this.menuLeft,this.menuTop);this.menuTop=e.top,this.menuLeft=e.left,this.menuX=s,this.menuY=i},onMenuEnd:function(){},handleBorderJudgment:function(t,s){return t<0?t=0:t>this.canvasWidth-35&&(t=this.canvasWidth-35),s<0?s=0:s>this.canvasHeight-27&&(s=this.canvasHeight-27),{left:t,top:s}},onClickEdit:function(){this.adjustVisible=!0,this.mouseStatus="brush"},onClickEraser:function(){this.eraserVisible=!0,this.mouseStatus="eraser"}}},r=h,l=(i("5118"),i("2877")),u=Object(l["a"])(r,e,a,!1,null,"075c0b37",null);s["default"]=u.exports}}]);
//# sourceMappingURL=board3.1987d632.js.map