{"version":3,"sources":["webpack:///./src/views/HandWritingBoard2/index.vue?2325","webpack:///src/views/HandWritingBoard2/index.vue","webpack:///./src/views/HandWritingBoard2/index.vue?445d","webpack:///./src/views/HandWritingBoard2/index.vue","webpack:///./src/views/HandWritingBoard2/index.vue?50af"],"names":["render","_vm","this","_h","$createElement","_c","_self","ref","staticClass","app","_v","staticStyle","attrs","filePath","canvasWidth","canvasHeight","on","$event","handleSelectTouch","handleGetContainer","model","value","callback","$$v","adjustVisible","expression","slot","lineWidth","style","background","lineColor","colorVisible","pickerColor","_e","onClear","onGenerate","mouseStatus","_s","onUndo","onReduction","staticRenderFns","name","props","path","type","String","default","components","data","offsetWidth","offsetHeight","c1px","c1py","boardData","boardStatus","watch","now","hex8","computed","navigator","userAgent","includes","mounted","init","methods","canvas","ctx","getContext","setBoardStatus","handleDraw","moveTo","lineTo","x","y","stroke","onBrushStart","offsetLeft","e","target","offsetTop","beginPath","strokeStyle","lineCap","lineJoin","touches","clientX","clientY","onBrushMove","onBrushEnd","closePath","clearRect","$nextTick","$emit","$refs","writingCanvas","toDataURL","onEraserStart","clearArc","onEraserMove","clearLine","onEraserEnd","save","arc","radius","Math","PI","clip","restore","endX","endY","sinX","cosY","box","getInitialCapital","val","replace","putImageData","$message","info","length","push","component"],"mappings":"0IAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,IAAI,MAAMC,YAAY,gBAAgB,CAAGP,EAAIQ,IAAklFJ,EAAG,MAAM,CAACJ,EAAIS,GAAG,eAA9lFL,EAAG,MAAM,CAACM,YAAY,CAAC,OAAS,SAAS,CAAEV,EAAY,SAAEI,EAAG,MAAM,CAACO,MAAM,CAAC,IAAMX,EAAIY,SAAS,IAAM,MAAMR,EAAG,SAAS,CAACE,IAAI,gBAAgBC,YAAY,cAAcI,MAAM,CAAC,MAAQX,EAAIa,YAAY,OAASb,EAAIc,cAAcC,GAAG,CAAC,WAAa,SAASC,GAAQ,OAAOhB,EAAIiB,kBAAkBD,EAAQ,UAAU,UAAY,SAASA,GAAQ,OAAOhB,EAAIiB,kBAAkBD,EAAQ,SAAS,SAAW,SAASA,GAAQ,OAAOhB,EAAIiB,kBAAkBD,EAAQ,WAAWZ,EAAG,MAAM,CAACG,YAAY,WAAW,CAACH,EAAG,YAAY,CAACO,MAAM,CAAC,oBAAqB,EAAK,kBAAoBX,EAAIkB,oBAAoBC,MAAM,CAACC,MAAOpB,EAAiB,cAAEqB,SAAS,SAAUC,GAAMtB,EAAIuB,cAAcD,GAAKE,WAAW,kBAAkB,CAACpB,EAAG,WAAW,CAACqB,KAAK,SAAS,CAACrB,EAAG,MAAM,CAACG,YAAY,iBAAiB,CAACH,EAAG,OAAO,CAACJ,EAAIS,GAAG,UAAUL,EAAG,SAAS,CAACO,MAAM,CAAC,KAAO,gBAAgBI,GAAG,CAAC,MAAQ,SAASC,GAAQhB,EAAIuB,eAAgB,OAAW,KAAKnB,EAAG,WAAW,CAACqB,KAAK,WAAW,CAACrB,EAAG,MAAM,CAACG,YAAY,kBAAkB,CAACH,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACO,MAAM,CAAC,KAAO,IAAI,CAACX,EAAIS,GAAG,UAAUL,EAAG,QAAQ,CAACO,MAAM,CAAC,KAAO,KAAK,CAACP,EAAG,WAAW,CAACO,MAAM,CAAC,IAAM,EAAE,IAAM,IAAIQ,MAAM,CAACC,MAAOpB,EAAa,UAAEqB,SAAS,SAAUC,GAAMtB,EAAI0B,UAAUJ,GAAKE,WAAW,gBAAgB,IAAI,GAAGpB,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACO,MAAM,CAAC,KAAO,IAAI,CAACX,EAAIS,GAAG,UAAUL,EAAG,QAAQ,CAACO,MAAM,CAAC,KAAO,KAAK,CAACP,EAAG,MAAM,CAACG,YAAY,aAAaoB,MAAM,CAAGC,WAAY5B,EAAI6B,WAAad,GAAG,CAAC,MAAQ,SAASC,GAAQhB,EAAI8B,cAAe,MAAU9B,EAAgB,aAAEI,EAAG,MAAM,CAACG,YAAY,cAAc,CAACH,EAAG,SAAS,CAACG,YAAY,gBAAgBI,MAAM,CAAC,KAAO,gBAAgBI,GAAG,CAAC,MAAQ,SAASC,GAAQhB,EAAI8B,cAAe,MAAU1B,EAAG,gBAAgB,CAACe,MAAM,CAACC,MAAOpB,EAAe,YAAEqB,SAAS,SAAUC,GAAMtB,EAAI+B,YAAYT,GAAKE,WAAW,kBAAkB,GAAGxB,EAAIgC,QAAQ,IAAI,KAAK5B,EAAG,WAAW,CAACG,YAAY,iBAAiBI,MAAM,CAAC,KAAO,WAAWI,GAAG,CAAC,MAAQ,SAASC,GAAQhB,EAAIuB,eAAgB,KAAQ,CAACvB,EAAIS,GAAG,WAAW,GAAGL,EAAG,WAAW,CAACG,YAAY,gBAAgBI,MAAM,CAAC,KAAO,WAAWI,GAAG,CAAC,MAAQf,EAAIiC,UAAU,CAACjC,EAAIS,GAAG,QAAQL,EAAG,WAAW,CAACG,YAAY,mBAAmBI,MAAM,CAAC,KAAO,WAAWI,GAAG,CAAC,MAAQf,EAAIkC,aAAa,CAAClC,EAAIS,GAAG,QAAQL,EAAG,WAAW,CAACG,YAAY,iBAAiBG,YAAY,CAAC,QAAU,KAAKC,MAAM,CAAC,KAAO,WAAWI,GAAG,CAAC,MAAQ,SAASC,GAAQhB,EAAImC,YAAkC,UAApBnC,EAAImC,YAA0B,SAAW,WAAW,CAACnC,EAAIS,GAAG,MAAMT,EAAIoC,GAAuB,UAApBpC,EAAImC,YAA0B,MAAQ,SAAS/B,EAAG,WAAW,CAACG,YAAY,eAAeI,MAAM,CAAC,KAAO,WAAWI,GAAG,CAAC,MAAQf,EAAIqC,SAAS,CAACrC,EAAIS,GAAG,QAAQL,EAAG,WAAW,CAACG,YAAY,oBAAoBI,MAAM,CAAC,KAAO,WAAWI,GAAG,CAAC,MAAQf,EAAIsC,cAAc,CAACtC,EAAIS,GAAG,SAAS,QAChuF8B,EAAkB,G,4CC2EtB,GACEC,KAAM,cACNC,MAAO,CACLC,KAAM,CACJC,KAAMC,OACNC,QAAS,KAGbC,WAAY,CACV,gBAAiB,EAArB,WAEEC,KAAM,WACJ,MAAO,CAELC,YAAa,EACbC,aAAc,EAEdpC,YAAa,IAEbC,aAAc,IAEdY,UAAW,GAEXK,YAAa,GAEbF,UAAW,OAEXjB,SAAU,GAEVsC,KAAM,EACNC,KAAM,EACN5B,eAAe,EACfO,cAAc,EAEdK,YAAa,QAEbiB,UAAW,GACXC,YAAa,IAGjBC,MAAO,CACLvB,YAAa,SAAjB,GACM9B,KAAK4B,UAAY0B,EAAIC,OAGzBC,SAAU,CACRjD,IADJ,WAEM,QAAIkD,UAAUC,UAAUC,SAAS,eAOrCC,QAtDF,WAuDI5D,KAAK6D,QAEPC,QAAS,CAEPD,KAFJ,WAGM7D,KAAKoD,aAAe,EACpBpD,KAAKmD,UAAY,GAEjB,IAAN,2BACMnD,KAAKY,YAAcmD,EAAOhB,YAC1B/C,KAAKa,aAAekD,EAAOf,aAE3BhD,KAAKgE,IAAMD,EAAOE,WAAW,MACX,KAAdjE,KAAKyC,KACPzC,KAAKW,SAAWX,KAAKyC,KAErBzC,KAAKkE,eACb,gEAKIlD,kBApBJ,SAoBA,KACM,IAAN,2CACM,OAAQ0B,GACN,IAAK,QACH1C,KAAK,KAAf,sBACU,MACF,IAAK,OACHA,KAAK,KAAf,qBACU,MACF,IAAK,MACHA,KAAK,KAAf,oBACU,MACF,QACE,QAGNmE,WApCJ,SAoCA,GAEM,IAAN,uCACA,sCAEMnE,KAAKgE,IAAII,OAAOpE,KAAKiD,KAAMjD,KAAKkD,MAChClD,KAAKgE,IAAIK,OAAOC,EAAGC,GACnBvE,KAAKgE,IAAIQ,SACTxE,KAAKiD,KAAOqB,EACZtE,KAAKkD,KAAOqB,GAGdE,aAhDJ,SAgDA,GAEMzE,KAAK0E,WAAaC,EAAEC,OAAOF,WAC3B1E,KAAK6E,UAAYF,EAAEC,OAAOC,UAC1B7E,KAAKgE,IAAIc,YACT9E,KAAKgE,IAAIvC,UAAYzB,KAAKyB,UAC1BzB,KAAKgE,IAAIe,YAAc/E,KAAK4B,UAC5B5B,KAAKgE,IAAIgB,QAAU,QACnBhF,KAAKgE,IAAIiB,SAAW,QACpBjF,KAAKiD,KAAO0B,EAAEO,QAAQ,GAAGC,QAAUnF,KAAK0E,WACxC1E,KAAKkD,KAAOyB,EAAEO,QAAQ,GAAGE,QAAUpF,KAAK6E,UACxC7E,KAAKmE,WAAWQ,IAGlBU,YA9DJ,SA8DA,GACMrF,KAAKmE,WAAWQ,IAGlBW,WAlEJ,WAmEMtF,KAAKgE,IAAIuB,YACTvF,KAAKkE,eACX,gEAIIlC,QAzEJ,WAyEA,WACMhC,KAAKgE,IAAIwB,UAAU,EAAG,EAAGxF,KAAKY,YAAaZ,KAAKa,cAChDb,KAAKW,SAAW,GAChBX,KAAKyF,WAAU,WACb,EAAR,UAGMzF,KAAK0F,MAAM,YAGbzD,WAnFJ,WAoFUjC,KAAKW,SACPX,KAAKW,SAAWX,KAAKW,UAErBX,KAAKW,SAAWX,KAAK2F,MAAMC,cAAcC,YAEzC7F,KAAK0F,MAAM,aAAc1F,KAAKW,YAKlCmF,cA9FJ,SA8FA,GACM9F,KAAK0E,WAAaC,EAAEC,OAAOF,WAC3B1E,KAAK6E,UAAYF,EAAEC,OAAOC,UAC1B7E,KAAKiD,KAAO0B,EAAEO,QAAQ,GAAGC,QAAUnF,KAAK0E,WACxC1E,KAAKkD,KAAOyB,EAAEO,QAAQ,GAAGE,QAAUpF,KAAK6E,UACxC7E,KAAK+F,SAAS/F,KAAKiD,KAAMjD,KAAKkD,KAAMlD,KAAKyB,UAAY,IAGvDuE,aAtGJ,SAsGA,GACMhG,KAAKiG,UAAUtB,EAAG3E,KAAKyB,UAAY,IAGrCyE,YA1GJ,WA2GMlG,KAAKkE,eACX,gEAII6B,SAhHJ,SAgHA,OACM/F,KAAKgE,IAAImC,OACTnG,KAAKgE,IAAIc,YACT9E,KAAKgE,IAAIoC,IAAI9B,EAAGC,EAAG8B,EAAQ,EAAG,EAAIC,KAAKC,IACvCvG,KAAKgE,IAAIwC,OACTxG,KAAKgE,IAAIwB,UAAU,EAAG,EAAGxF,KAAKY,YAAaZ,KAAKa,cAChDb,KAAKgE,IAAIyC,WAGXR,UAzHJ,SAyHA,KACMjG,KAAK0E,WAAaC,EAAEC,OAAOF,WAC3B1E,KAAK6E,UAAYF,EAAEC,OAAOC,UAC1B,IAAN,uCACA,sCACM7E,KAAK+F,SAASW,EAAMC,EAAMN,GAG1B,IAAN,EACA,mDACA,EACA,mDACMrG,KAAKgE,IAAImC,OACTnG,KAAKgE,IAAIc,YACT9E,KAAKgE,IAAII,OAAOpE,KAAKiD,KAAO2D,EAAM5G,KAAKkD,KAAO2D,GAC9C7G,KAAKgE,IAAIK,OAAOrE,KAAKiD,KAAO2D,EAAM5G,KAAKkD,KAAO2D,GAC9C7G,KAAKgE,IAAIK,OAAOqC,EAAOE,EAAMD,EAAOE,GACpC7G,KAAKgE,IAAIK,OAAOqC,EAAOE,EAAMD,EAAOE,GACpC7G,KAAKgE,IAAIuB,YACTvF,KAAKgE,IAAIwC,OACTxG,KAAKgE,IAAIwB,UAAU,EAAG,EAAGxF,KAAKY,YAAaZ,KAAKa,cAChDb,KAAKgE,IAAIyC,UACTzG,KAAKiD,KAAOyD,EACZ1G,KAAKkD,KAAOyD,GAId1F,mBApJJ,WAqJM,OAAOjB,KAAK2F,MAAMmB,KAGpBC,kBAxJJ,SAwJA,GACM,OAAOC,EAAIC,QAAQ,MAAM,SAA/B,8BAGI7E,OA5JJ,WA6JMpC,KAAKoD,cACDpD,KAAKoD,aAAe,EACtBpD,KAAKgE,IAAIkD,aAAalH,KAAKmD,UAAUnD,KAAKoD,aAAc,EAAG,IAE3DpD,KAAKoD,cACLpD,KAAKmH,SAASC,KAAK,aAIvB/E,YAtKJ,WAuKMrC,KAAKoD,cACDpD,KAAKoD,YAAcpD,KAAKmD,UAAUkE,OACpCrH,KAAKgE,IAAIkD,aAAalH,KAAKmD,UAAUnD,KAAKoD,aAAc,EAAG,IAE3DpD,KAAKoD,cACLpD,KAAKmH,SAASC,KAAK,aAGvBlD,eA/KJ,SA+KA,GACMlE,KAAKmD,UAAUmE,KAAKxE,GACpB9C,KAAKoD,aAAe,KCtToU,I,wBCQ1VmE,EAAY,eACd,EACAzH,EACAwC,GACA,EACA,KACA,WACA,MAIa,aAAAiF,E,2CCnBf,yBAAmf,EAAG","file":"js/board2.5d38decb.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"box\",staticClass:\"hand-writing\"},[(!_vm.app)?_c('div',{staticStyle:{\"height\":\"100%\"}},[(_vm.filePath)?_c('img',{attrs:{\"src\":_vm.filePath,\"alt\":\"\"}}):_c('canvas',{ref:\"writingCanvas\",staticClass:\"writing-box\",attrs:{\"width\":_vm.canvasWidth,\"height\":_vm.canvasHeight},on:{\"touchstart\":function($event){return _vm.handleSelectTouch($event, 'start')},\"touchmove\":function($event){return _vm.handleSelectTouch($event, 'move')},\"touchend\":function($event){return _vm.handleSelectTouch($event, 'end')}}}),_c('div',{staticClass:\"btn-box\"},[_c('a-popover',{attrs:{\"arrowPointAtCenter\":true,\"getPopupContainer\":_vm.handleGetContainer},model:{value:(_vm.adjustVisible),callback:function ($$v) {_vm.adjustVisible=$$v},expression:\"adjustVisible\"}},[_c('template',{slot:\"title\"},[_c('div',{staticClass:\"adjust-header\"},[_c('span',[_vm._v(\"调节笔画\")]),_c('a-icon',{attrs:{\"type\":\"close-circle\"},on:{\"click\":function($event){_vm.adjustVisible = false}}})],1)]),_c('template',{slot:\"content\"},[_c('div',{staticClass:\"adjust-content\"},[_c('a-row',[_c('a-col',{attrs:{\"span\":8}},[_vm._v(\"线条粗细\")]),_c('a-col',{attrs:{\"span\":16}},[_c('a-slider',{attrs:{\"min\":1,\"max\":20},model:{value:(_vm.lineWidth),callback:function ($$v) {_vm.lineWidth=$$v},expression:\"lineWidth\"}})],1)],1),_c('a-row',[_c('a-col',{attrs:{\"span\":8}},[_vm._v(\"线条颜色\")]),_c('a-col',{attrs:{\"span\":16}},[_c('div',{staticClass:\"color-body\",style:({ background: _vm.lineColor }),on:{\"click\":function($event){_vm.colorVisible = true}}}),(_vm.colorVisible)?_c('div',{staticClass:\"picker-box\"},[_c('a-icon',{staticClass:\"picker-cancel\",attrs:{\"type\":\"close-circle\"},on:{\"click\":function($event){_vm.colorVisible = false}}}),_c('chrome-picker',{model:{value:(_vm.pickerColor),callback:function ($$v) {_vm.pickerColor=$$v},expression:\"pickerColor\"}})],1):_vm._e()])],1)],1)]),_c('a-button',{staticClass:\"btn btn-adjust\",attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.adjustVisible = true}}},[_vm._v(\"调节笔画\")])],2),_c('a-button',{staticClass:\"btn btn-clear\",attrs:{\"type\":\"primary\"},on:{\"click\":_vm.onClear}},[_vm._v(\"清屏\")]),_c('a-button',{staticClass:\"btn btn-generate\",attrs:{\"type\":\"primary\"},on:{\"click\":_vm.onGenerate}},[_vm._v(\"生成\")]),_c('a-button',{staticClass:\"btn btn-switch\",staticStyle:{\"padding\":\"0\"},attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.mouseStatus = _vm.mouseStatus === 'brush' ? 'eraser' : 'brush'}}},[_vm._v(\"切换为\"+_vm._s(_vm.mouseStatus === \"brush\" ? \"橡皮檫\" : \"画笔\"))]),_c('a-button',{staticClass:\"btn btn-undo\",attrs:{\"type\":\"primary\"},on:{\"click\":_vm.onUndo}},[_vm._v(\"撤销\")]),_c('a-button',{staticClass:\"btn btn-reduction\",attrs:{\"type\":\"primary\"},on:{\"click\":_vm.onReduction}},[_vm._v(\"还原\")])],1)]):_c('div',[_vm._v(\"暂不支持QQ浏览器\")])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div ref=\"box\" class=\"hand-writing\">\r\n    <div v-if=\"!app\" style=\"height: 100%\">\r\n      <img v-if=\"filePath\" :src=\"filePath\" alt />\r\n      <canvas\r\n        v-else\r\n        ref=\"writingCanvas\"\r\n        class=\"writing-box\"\r\n        :width=\"canvasWidth\"\r\n        :height=\"canvasHeight\"\r\n        @touchstart=\"handleSelectTouch($event, 'start')\"\r\n        @touchmove=\"handleSelectTouch($event, 'move')\"\r\n        @touchend=\"handleSelectTouch($event, 'end')\"\r\n      ></canvas>\r\n      <div class=\"btn-box\">\r\n        <!-- 调节弹框 -->\r\n        <a-popover\r\n          v-model=\"adjustVisible\"\r\n          :arrowPointAtCenter=\"true\"\r\n          :getPopupContainer=\"handleGetContainer\"\r\n        >\r\n          <template slot=\"title\">\r\n            <div class=\"adjust-header\">\r\n              <span>调节笔画</span>\r\n              <a-icon type=\"close-circle\" @click=\"adjustVisible = false\" />\r\n            </div>\r\n          </template>\r\n          <template slot=\"content\">\r\n            <div class=\"adjust-content\">\r\n              <a-row>\r\n                <a-col :span=\"8\">线条粗细</a-col>\r\n                <a-col :span=\"16\">\r\n                  <a-slider :min=\"1\" :max=\"20\" v-model=\"lineWidth\" />\r\n                </a-col>\r\n              </a-row>\r\n              <a-row>\r\n                <a-col :span=\"8\">线条颜色</a-col>\r\n                <a-col :span=\"16\">\r\n                  <div\r\n                    class=\"color-body\"\r\n                    :style=\"{ background: lineColor }\"\r\n                    @click=\"colorVisible = true\"\r\n                  ></div>\r\n                  <div class=\"picker-box\" v-if=\"colorVisible\">\r\n                    <a-icon\r\n                      class=\"picker-cancel\"\r\n                      type=\"close-circle\"\r\n                      @click=\"colorVisible = false\"\r\n                    />\r\n                    <chrome-picker v-model=\"pickerColor\" />\r\n                  </div>\r\n                </a-col>\r\n              </a-row>\r\n            </div>\r\n          </template>\r\n          <a-button type=\"primary\" class=\"btn btn-adjust\" @click=\"adjustVisible = true\">调节笔画</a-button>\r\n        </a-popover>\r\n\r\n        <a-button type=\"primary\" class=\"btn btn-clear\" @click=\"onClear\">清屏</a-button>\r\n        <a-button type=\"primary\" class=\"btn btn-generate\" @click=\"onGenerate\">生成</a-button>\r\n        <a-button\r\n          type=\"primary\"\r\n          class=\"btn btn-switch\"\r\n          style=\"padding: 0\"\r\n          @click=\"mouseStatus = mouseStatus === 'brush' ? 'eraser' : 'brush'\"\r\n        >切换为{{ mouseStatus === \"brush\" ? \"橡皮檫\" : \"画笔\" }}</a-button>\r\n        <a-button type=\"primary\" class=\"btn btn-undo\" @click=\"onUndo\">撤销</a-button>\r\n        <a-button type=\"primary\" class=\"btn btn-reduction\" @click=\"onReduction\">还原</a-button>\r\n      </div>\r\n    </div>\r\n    <div v-else>暂不支持QQ浏览器</div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { Chrome } from \"vue-color\";\r\nexport default {\r\n  name: \"HandWriting\",\r\n  props: {\r\n    path: {\r\n      type: String,\r\n      default: \"\"\r\n    }\r\n  },\r\n  components: {\r\n    \"chrome-picker\": Chrome\r\n  },\r\n  data: function() {\r\n    return {\r\n      // 画板坐标\r\n      offsetWidth: 0,\r\n      offsetHeight: 0,\r\n      // 画板宽度\r\n      canvasWidth: 500,\r\n      // 画板高度\r\n      canvasHeight: 500,\r\n      // 线条宽度\r\n      lineWidth: 10,\r\n      // 调色板颜色\r\n      pickerColor: {},\r\n      // 线条颜色\r\n      lineColor: \"#000\",\r\n      // 图片地址\r\n      filePath: \"\",\r\n      // 辅助坐标\r\n      c1px: 0,\r\n      c1py: 0,\r\n      adjustVisible: false,\r\n      colorVisible: false,\r\n      // 鼠标状态: brush eraser\r\n      mouseStatus: \"brush\",\r\n      // 绘画状态\r\n      boardData: [],\r\n      boardStatus: 0\r\n    };\r\n  },\r\n  watch: {\r\n    pickerColor: function(now) {\r\n      this.lineColor = now.hex8;\r\n    }\r\n  },\r\n  computed: {\r\n    app() {\r\n      if (navigator.userAgent.includes(\"QQBrowser\")) {\r\n        return true;\r\n      } else {\r\n        return false;\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    this.init();\r\n  },\r\n  methods: {\r\n    // 画板初始化\r\n    init() {\r\n      this.boardStatus = -1;\r\n      this.boardData = [];\r\n      // 获取canvas\r\n      const canvas = this.$refs.writingCanvas;\r\n      this.canvasWidth = canvas.offsetWidth;\r\n      this.canvasHeight = canvas.offsetHeight;\r\n      // 获取context对象\r\n      this.ctx = canvas.getContext(\"2d\");\r\n      if (this.path !== \"\") {\r\n        this.filePath = this.path;\r\n      } else {\r\n        this.setBoardStatus(\r\n          this.ctx.getImageData(0, 0, this.canvasWidth, this.canvasHeight)\r\n        );\r\n      }\r\n    },\r\n    // 判断画笔属性\r\n    handleSelectTouch(e, type) {\r\n      let _data = this.getInitialCapital(this.mouseStatus);\r\n      switch (type) {\r\n        case \"start\":\r\n          this[`on${_data}Start`](e);\r\n          break;\r\n        case \"move\":\r\n          this[`on${_data}Move`](e);\r\n          break;\r\n        case \"end\":\r\n          this[`on${_data}End`](e);\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    },\r\n    handleDraw(e) {\r\n      // 获取点击点的坐标\r\n      let x = e.touches[0].clientX - this.offsetLeft;\r\n      let y = e.touches[0].clientY - this.offsetTop;\r\n      // 绘制\r\n      this.ctx.moveTo(this.c1px, this.c1py);\r\n      this.ctx.lineTo(x, y);\r\n      this.ctx.stroke();\r\n      this.c1px = x;\r\n      this.c1py = y;\r\n    },\r\n    // 开始触摸\r\n    onBrushStart(e) {\r\n      // 获取偏移量\r\n      this.offsetLeft = e.target.offsetLeft;\r\n      this.offsetTop = e.target.offsetTop;\r\n      this.ctx.beginPath();\r\n      this.ctx.lineWidth = this.lineWidth;\r\n      this.ctx.strokeStyle = this.lineColor;\r\n      this.ctx.lineCap = \"round\";\r\n      this.ctx.lineJoin = \"round\";\r\n      this.c1px = e.touches[0].clientX - this.offsetLeft;\r\n      this.c1py = e.touches[0].clientY - this.offsetTop;\r\n      this.handleDraw(e);\r\n    },\r\n    // 移动\r\n    onBrushMove(e) {\r\n      this.handleDraw(e);\r\n    },\r\n    // 停止触摸\r\n    onBrushEnd() {\r\n      this.ctx.closePath();\r\n      this.setBoardStatus(\r\n        this.ctx.getImageData(0, 0, this.canvasWidth, this.canvasHeight)\r\n      );\r\n    },\r\n    // 点击取消\r\n    onClear() {\r\n      this.ctx.clearRect(0, 0, this.canvasWidth, this.canvasHeight);\r\n      this.filePath = \"\";\r\n      this.$nextTick(() => {\r\n        this.init();\r\n      });\r\n      // 清除的回调\r\n      this.$emit(\"onClear\");\r\n    },\r\n    // 点击确认\r\n    onGenerate() {\r\n      if (this.filePath) {\r\n        this.filePath = this.filePath;\r\n      } else {\r\n        this.filePath = this.$refs.writingCanvas.toDataURL();\r\n        // 生成图片的回调\r\n        this.$emit(\"onComplete\", this.filePath);\r\n      }\r\n    },\r\n\r\n    // 橡皮擦移动开始\r\n    onEraserStart(e) {\r\n      this.offsetLeft = e.target.offsetLeft;\r\n      this.offsetTop = e.target.offsetTop;\r\n      this.c1px = e.touches[0].clientX - this.offsetLeft;\r\n      this.c1py = e.touches[0].clientY - this.offsetTop;\r\n      this.clearArc(this.c1px, this.c1py, this.lineWidth / 2);\r\n      // this.clearArc(e, this.lineWidth / 2);\r\n    },\r\n    onEraserMove(e) {\r\n      this.clearLine(e, this.lineWidth / 2);\r\n    },\r\n    // 橡皮擦移动结束\r\n    onEraserEnd() {\r\n      this.setBoardStatus(\r\n        this.ctx.getImageData(0, 0, this.canvasWidth, this.canvasHeight)\r\n      );\r\n    },\r\n    // 画圆\r\n    clearArc(x, y, radius) {\r\n      this.ctx.save();\r\n      this.ctx.beginPath();\r\n      this.ctx.arc(x, y, radius, 0, 2 * Math.PI);\r\n      this.ctx.clip();\r\n      this.ctx.clearRect(0, 0, this.canvasWidth, this.canvasHeight);\r\n      this.ctx.restore();\r\n    },\r\n    // 画矩形\r\n    clearLine(e, radius) {\r\n      this.offsetLeft = e.target.offsetLeft;\r\n      this.offsetTop = e.target.offsetTop;\r\n      let endX = e.touches[0].clientX - this.offsetLeft;\r\n      let endY = e.touches[0].clientY - this.offsetTop;\r\n      this.clearArc(endX, endY, radius);\r\n\r\n      // 计算辅助边长\r\n      let sinX =\r\n        radius * Math.sin(Math.atan((endY - this.c1py) / (endX - this.c1px)));\r\n      let cosY =\r\n        radius * Math.cos(Math.atan((endY - this.c1py) / (endX - this.c1px)));\r\n      this.ctx.save();\r\n      this.ctx.beginPath();\r\n      this.ctx.moveTo(this.c1px - sinX, this.c1py + cosY);\r\n      this.ctx.lineTo(this.c1px + sinX, this.c1py - cosY);\r\n      this.ctx.lineTo(endX + sinX, endY - cosY);\r\n      this.ctx.lineTo(endX - sinX, endY + cosY);\r\n      this.ctx.closePath();\r\n      this.ctx.clip();\r\n      this.ctx.clearRect(0, 0, this.canvasWidth, this.canvasHeight);\r\n      this.ctx.restore();\r\n      this.c1px = endX;\r\n      this.c1py = endY;\r\n    },\r\n\r\n    // 挂载DOM\r\n    handleGetContainer() {\r\n      return this.$refs.box;\r\n    },\r\n    // 将字符串转换为首字母大写的形式\r\n    getInitialCapital(val) {\r\n      return val.replace(/\\S/, item => item.toUpperCase());\r\n    },\r\n    // 撤销\r\n    onUndo() {\r\n      this.boardStatus--;\r\n      if (this.boardStatus >= 0) {\r\n        this.ctx.putImageData(this.boardData[this.boardStatus], 0, 0);\r\n      } else {\r\n        this.boardStatus++;\r\n        this.$message.info(\"已经是第一步了\");\r\n      }\r\n    },\r\n    // 还原\r\n    onReduction() {\r\n      this.boardStatus++;\r\n      if (this.boardStatus < this.boardData.length) {\r\n        this.ctx.putImageData(this.boardData[this.boardStatus], 0, 0);\r\n      } else {\r\n        this.boardStatus--;\r\n        this.$message.info(\"已经是最新的了\");\r\n      }\r\n    },\r\n    setBoardStatus(data) {\r\n      this.boardData.push(data);\r\n      this.boardStatus += 1;\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"css\" scoped>\r\n.hand-writing {\r\n  width: 100%;\r\n  height: 100%;\r\n  background: #fff;\r\n}\r\n\r\n.writing-box {\r\n  display: block;\r\n  margin: 0 auto;\r\n  width: 100%;\r\n  height: 80%;\r\n}\r\n.btn-box {\r\n  border-top: 1px solid #000;\r\n  margin: 0 auto;\r\n  padding-top: 10px;\r\n  height: 20%;\r\n  overflow-y: auto;\r\n}\r\n.btn {\r\n  margin: 0 15px;\r\n  width: 100px;\r\n  height: 50px;\r\n  line-height: 50px;\r\n}\r\n\r\n.adjust-header {\r\n  display: flex;\r\n  width: 188px;\r\n}\r\n\r\n.adjust-header span {\r\n  flex: 1;\r\n}\r\n\r\n.adjust-header .anticon {\r\n  flex: 1;\r\n  text-align: right;\r\n  line-height: 21px;\r\n}\r\n.ant-row {\r\n  line-height: 36px;\r\n}\r\n.color-body {\r\n  margin-left: 5px;\r\n  vertical-align: sub;\r\n  display: inline-block;\r\n  width: 15px;\r\n  height: 15px;\r\n  border-radius: 50%;\r\n  background: #000;\r\n}\r\n.picker-box {\r\n  position: absolute;\r\n  padding: 10px;\r\n  background: #fff;\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\r\n  bottom: 30px;\r\n  left: 10px;\r\n}\r\n.picker-box .picker-cancel {\r\n  float: right;\r\n  height: 20px;\r\n  line-height: 20px;\r\n}\r\n\r\n.picker-box .vc-chrome {\r\n  box-shadow: 0 0 0;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=137f3bfd&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=137f3bfd&lang=css&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"137f3bfd\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=137f3bfd&lang=css&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=137f3bfd&lang=css&scoped=true&\""],"sourceRoot":""}